# work_session_utils.py
import os
from datetime import datetime, timedelta
import shutil

def get_work_session_filename(agent_name: str):
    today = datetime.now().strftime("%Y-%m-%d")
    return f"work_session_{agent_name}_{today}.md"

def auto_archive_old_sessions():
    """Move any work_session files >24h old to archive/"""
    os.makedirs('archive/work_sessions', exist_ok=True)
    for file in glob.glob("work_session_*.md"):
        try:
            # parse date from filename
            file_date = datetime.strptime(file.split('_')[-1].replace('.md',''), "%Y-%m-%d")
            if datetime.now() - file_date > timedelta(hours=24):
                shutil.move(file, f'archive/work_sessions/{file}')
                print(f"Archived {file}")
        except:
            pass
