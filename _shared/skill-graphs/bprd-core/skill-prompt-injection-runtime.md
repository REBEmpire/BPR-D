---
Date: 2026-02-18
Author: "Claude | Model: claude-sonnet-4-6"
Version: v1.0
Status: Active
---

# Skill: Dynamic Prompt Injection at Runtime

**Domain:** Agent Cognition | **Tier:** Advanced
**Used by:** Meeting Engine Phase 0, work_session prompt builder
**Back to:** [[MOC-Core]]

---

## What It Does

Identifies the **domain of the current session's top backlog items** and dynamically injects the relevant skill sub-graph into the session prompt. Agents get the procedural knowledge they need, exactly when they need it — without human intervention.

---

## Injection Pipeline

```
Phase 0: Context Assembly
    ├── backlog/discovery.py → top-5 items
    ├── Identify domain tags from items:
    │   ├── "hive" → [[skill-hive-content-pipeline]]
    │   ├── "handoff" → [[skill-handoff-protocols]]
    │   ├── "deploy" → [[skill-render-deployment]]
    │   ├── "research" → [[skill-research-brief-format]]
    │   ├── "cost" / "budget" → [[skill-cost-governance]]
    │   └── default → [[skill-meeting-engine]], [[MOC-Core]]
    ├── Load matched skill nodes (via [[skill-wiki-link-traversal]])
    └── Inject as "## Relevant Skills" block in prompt
```

---

## Domain Tag Detection

```python
DOMAIN_TAGS = {
    "hive": ["skill-hive-content-pipeline", "skill-image-prompt-standards"],
    "handoff": ["skill-handoff-protocols", "skill-handoff-ingestion"],
    "deploy": ["skill-render-deployment", "skill-github-commit-automation"],
    "research": ["skill-research-brief-format", "skill-content-template-system"],
    "cost": ["skill-cost-governance"],
    "quality": ["skill-quality-filter", "skill-peer-review-protocol"],
    "graph": ["skill-graph-self-maintenance", "skill-wiki-link-traversal"],
}

def detect_domains(backlog_items: list[BacklogItem]) -> list[str]:
    """Match backlog item text against domain tags."""
    domains = set()
    for item in backlog_items:
        text = f"{item.title} {item.context}".lower()
        for tag, skills in DOMAIN_TAGS.items():
            if tag in text:
                domains.update(skills)
    return list(domains)
```

---

## Injected Prompt Block

```markdown
## Relevant Skills (auto-loaded from skill graph)

### [skill-hive-content-pipeline]
Full brief → Hive post workflow. Research brief must include image prompts before
Daily Briefing. Hive accounts: @ddas-devblog, @ddas-lore, @ddas-strategy,
@ddas-community, @ddas-news...

### [skill-handoff-protocols]
Two-tier system: operational (agent/handoff.md) and escalation (_handoffs/).
Priority: URGENT/High/Medium/Low. Status: Pending/In Progress/Blocked/Done...
```

---

## Context Budget Management

Total prompt context is managed to stay within LLM limits:
- Backlog section: ~800 tokens
- Skill injection: ~400 tokens per skill, max 3 skills
- Agent context: ~500 tokens
- Conversation history: remainder

If context budget is tight, skill injection is reduced to "What It Does" sections only.

---

## Future: Semantic Match (Q2 2026)

Current: keyword tag matching
Target: embed all skill nodes with sentence-transformers, retrieve top-3 by cosine similarity to backlog item text. Zero manual tagging needed.

See [[skill-graph-self-maintenance]] for embedding pipeline design.

---

## Related Skills

- [[skill-backlog-discovery]] — provides the items that trigger injection
- [[skill-wiki-link-traversal]] — loads linked nodes from matched skills
- [[skill-meeting-engine]] — where injection happens (Phase 0)
- [[skill-graph-self-maintenance]] — keeps the skill corpus current
- [[skill-agent-self-evolution]] — agents can add new domain tags via /reflect

---

*Generated by: Claude | Model: claude-sonnet-4-6 | 2026-02-18*
